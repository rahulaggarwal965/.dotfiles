# Settings
set preview true
set previewer lfpreview
set cleaner lfclear
set hidden true
set ignorecase true
set tabstop 4
set mouse true
set promptfmt "\033[38;5;208m%u\033[38;5;247m :: \033[38;5;96m%d%f"

# Custom Functions
cmd open ${{
	case $(file --mime-type "$f" -bL) in
	    text/html) xdg-open "$f" ;;
		text/*|application/octet-stream|inode/x-empty) $EDITOR "$fx" ;;
		image/*) sxiv_dir "$f" ;;
		audio/*) $VIDEO --audio-display=no $f ;;
		video/*) setsid -f $VIDEO "$f" -quiet >/dev/null 2>&1 ;;
		application/pdf) setsid -f $READER "$fx" >/dev/null 2>&1 ;;
		*) xdg-open "$f" ;;
	esac
}}

cmd mkdir %{{
	printf "Directory Name: "
	read ans
	mkdir "$ans"
	lf -remote "send $id select \"$ans\""
}}

cmd mkfile %{{
	printf "File Name: "
	read ans
	touch "$ans"
	lf -remote "send $id select \"$ans\""
}}

cmd chmod %{{
	printf "Mode bits: "
	read ans

	for file in "$fx"
	do
		chmod $ans $file
	done
    lf -remote "send $id reload"
}}

cmd sudomkfile ${{
	printf "File Name: "
	read ans
	sudo $EDITOR $ans
}}

cmd bulk-rename ${{
    old="$(mktemp)"
    new="$(mktemp)"
    [ -n "$fx" ] && fs="$(ls)"
    printf '%s\n' "$fx" >"$old"
    printf '%s\n' "$fx" >"$new"
    $EDITOR "$new"
    [ "$(wc -l < "$new")" -ne "$(wc -l < "$old")" ] && exit
    paste "$old" "$new" | while IFS= read -r names; do
        src="$(printf '%s' "$names" | cut -f1)"
        dst="$(printf '%s' "$names" | cut -f2)"
        if [ "$src" = "$dst" ] || [ -e "$dst" ]; then
            continue
        fi
        mv -- "$src" "$dst"
    done
    rm -- "$old" "$new"
    lf -remote "send $id unselect"
}}

cmd tar %tar cvf "$f.tar" "$f"
cmd targz %tar cvzf "$f.tar.gz" "$f"
cmd tarbz2 %tar cjvf "$f.tar.bz2" "$f"

# Bindings
map <c-f> $lf -remote "send $id select '$(fzf)'"
map d
map c
map e
map r
map m
map u
map [
map ]

# Set Background
map sb %setbg "$f"

# File Openers
map v $$EDITOR "$fx"

map br bulk-rename "$fx"

# Archive Mappings
map ua %aunpack "$f"

# Basic Functions
map mm mark-save
map . set hidden!
map dd delete
map p paste
map x cut
map y copy
map <enter> open
map mf mkfile
map mr sudomkfile
map md mkdir
map ch chmod
map a rename
map A push a<c-u>
map I push a<a-b><a-b><a-f><c-u>
map i push a<a-b><a-b><a-f>
map H top
map L bottom
map R reload
map C clear
map U unselect
map V invert
map <m-up> up
map <m-down> down
map <m-left> updir
map <m-right> open
map <c-o> jump-prev
map <tab> jump-next

# Movement
map g/ cd /
map gc cd ~/.config
map gl cd ~/.local/share
map gs cd ~/.local/bin
map gS cd ~/Documents/Georgia_Tech
map gd cd ~/Documents
map gb cd ~/Documents/ebooks
map gD cd ~/Downloads
map gp cd ~/Pictures
map gv cd ~/Videos
map ga cd ~/Music
map gnp cd ~/.local/share/nvim/site/pack/packer
map gr cd ~/repos
